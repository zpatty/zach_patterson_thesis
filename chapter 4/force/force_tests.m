clear
close all
opts = detectImportOptions('mini_patrick.is_tens_RawData/Specimen_RawData_1.csv');

names = {'T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11'};
timeslices = {{0,6.174}, {31.3,51.516}, {6.174,16.188}, {51.516,70.96}, {16.188,31.3}, {70.96,92.171}, {92.171,109.303};
    {8.799,14.247}, {14.247,18.422}, {18.422,24.398}, {24.398,34.796}, {34.796,47.671}, {47.671,57.099}, {57.099,68.602};
    {0,7.387}, {7.387,13.332}, {13.332,19.869}, {19.869,27.511}, {44.303,58.021}, {76.05,84.246}, {93.952,109.623};
    {0,9.8}, {9.8,14.394}, {14.394,18.811}, {18.811,26.388}, {26.388,34.31}, {34.31,41.336}, {41.336,51.713};
    {36.243,42.316}, {42.316,46.344}, {46.344,50.636}, {58.812,63.33}, {50.636,58.812}, {75.192,81.82}, {87.678,101.745};
    {0,10.248}, {10.248,15.961}, {15.961,23.152}, {23.152,28.381}, {28.381,35.423}, {35.423,43.835}, {43.835,53.369};
    {0,1.774}, {1.774,5.609}, {5.609,11.886},{11.886,17.551},{21.768,31.339},{31.339,40.184},{40.184,51.062};
    {2.326,6.801},{6.801,12.207},{12.207,17.1},{17.1,23.597},{23.597,27.974},{27.974,33.903},{33.903,41.277};
    {0.999,4.666},{4.666,8.827},{8.827,13.112},{13.112,17.989},{17.989,25.786},{25.786,33.08},{33.08,49.161}};
peaks = zeros(9,7);
for i =1:9
    filename = strcat('mini_patrick.is_tens_RawData/Specimen_RawData_', num2str(i), '.csv');
    s.(names{i}) = readtable(filename, opts);
    %figure
    T = s.(names{i});
    %plot(T.Time, T.Load)
    force = T.Load;
    
    for j = 1:7
        bounds = timeslices(i,j);
        bounds = bounds{1};
        idx1 = find(T.Time==bounds{1});
        idx2 = find(T.Time==bounds{2});
        peak = max(-force(idx1:idx2));
        peaks(i,j) = peak;
    end
end
avg = mean(peaks)
stdev = std(peaks)
figure
errorbar([50 75 100 125 150 200 300],avg, stdev,'o', 'MarkerEdgeColor','red','MarkerFaceColor','red', 'Color', 'red')
%set(gcf, 'Position',  [100, 100, 500, 400])
set(gca,'FontSize',14)
xlim([1 349])
xlabel('Activation Time (ms)', 'FontSize', 16);
ylabel('Force (N)', 'FontSize', 16);